<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.154.5"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>ShellUnease (VXXDXX)</title>

<meta name="description" content="ShellUnease Write-ups">
<meta name="author" content="ShellUnease">
<link rel="canonical" href="http://localhost:1313/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/index.xml">
<link rel="alternate" type="application/json" href="http://localhost:1313/index.json">
<link rel="alternate" hreflang="en" href="http://localhost:1313/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="ShellUnease (VXXDXX) (Alt + H)">ShellUnease (VXXDXX)</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CSAW CTF Qualification Round 2024 Lost Pyramid
    </h2>
  </header>
  <div class="entry-content">
    <p>Initial Code Analysis First thing that catches our eye is the old version 2.3.0 of PyJWT used in the application.
In order to access the flag, we need to view kings_lair.html which requires sending a JWT with specific CURRENT_DATE and ROLE.
The scarab room seems vulnerable to SSTI via name POST param.
app.route(&#39;/scarab_room&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) def scarab_room(): try: if request.method == &#39;POST&#39;: name = request.form.get(&#39;name&#39;) if name: kings_safelist = [&#39;{&#39;,&#39;}&#39;, &#39;ğ“¹&#39;, &#39;ğ“†£&#39;,&#39;ğ“€€&#39;, &#39;ğ“€&#39;, &#39;ğ“€‚&#39;, &#39;ğ“€ƒ&#39;, &#39;ğ“€„&#39;, &#39;ğ“€…&#39;, &#39;ğ“€†&#39;, &#39;ğ“€‡&#39;, &#39;ğ“€ˆ&#39;, &#39;ğ“€‰&#39;, &#39;ğ“€Š&#39;, &#39;ğ“€&#39;, &#39;ğ“€‘&#39;, &#39;ğ“€’&#39;, &#39;ğ“€“&#39;, &#39;ğ“€”&#39;, &#39;ğ“€•&#39;, &#39;ğ“€–&#39;, &#39;ğ“€—&#39;, &#39;ğ“€˜&#39;, &#39;ğ“€™&#39;, &#39;ğ“€š&#39;, &#39;ğ“€›&#39;, &#39;ğ“€œ&#39;, &#39;ğ“€&#39;, &#39;ğ“€&#39;, &#39;ğ“€Ÿ&#39;, &#39;ğ“€ &#39;, &#39;ğ“€¡&#39;, &#39;ğ“€¢&#39;, &#39;ğ“€£&#39;, &#39;ğ“€¤&#39;, &#39;ğ“€¥&#39;, &#39;ğ“€¦&#39;, &#39;ğ“€§&#39;, &#39;ğ“€¨&#39;, &#39;ğ“€©&#39;, &#39;ğ“€ª&#39;, &#39;ğ“€«&#39;, &#39;ğ“€¬&#39;, &#39;ğ“€­&#39;, &#39;ğ“€®&#39;, &#39;ğ“€¯&#39;, &#39;ğ“€°&#39;, &#39;ğ“€±&#39;, &#39;ğ“€²&#39;, &#39;ğ“€³&#39;, &#39;ğ“€´&#39;, &#39;ğ“€µ&#39;, &#39;ğ“€¶&#39;, &#39;ğ“€·&#39;, &#39;ğ“€¸&#39;, &#39;ğ“€¹&#39;, &#39;ğ“€º&#39;, &#39;ğ“€»&#39;] name = &#39;&#39;.join([char for char in name if char.isalnum() or char in kings_safelist]) return render_template_string(&#39;&#39;&#39; &lt;!DOCTYPE html&gt; &lt;html lang=&#34;en&#34;&gt; &lt;head&gt; OMITTED &lt;/head&gt; &lt;body&gt; &lt;a href=&#34;{{ url_for(&#39;hallway&#39;) }}&#34; class=&#34;return-link&#34;&gt;RETURN&lt;/a&gt; {% if name %} &lt;h1&gt;ğ“¹ğ“¹ğ“¹ Welcome to the Scarab Room, &#39;&#39;&#39;&#43; name &#43; &#39;&#39;&#39; ğ“¹ğ“¹ğ“¹&lt;/h1&gt; {% endif %} &lt;/body&gt; &lt;/html&gt; &#39;&#39;&#39;, name=name, **globals()) except Exception as e: pass return render_template(&#39;scarab_room.html&#39;) Leaking Information via Scarab Room Since both { and } are in kings_safelist, we can send a Jinja2 expression in name to scarab_room. This allows us to leak any alphanumerical global variables by sending {{VARIABLE}}, since **globals() are included. Looking at the code, we can leak KINGSDAY and PUBLICKEY this way, but not PRIVATE_KEY, since it contains an underscore which isnâ€™t permitted.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-07 12:17:23 +0200 CEST'>September 7, 2024</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to CSAW CTF Qualification Round 2024 Lost Pyramid" href="http://localhost:1313/posts/csawctf-2024-lost-pyramid/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CyberSpace CTF 2024 Notekeeper
    </h2>
  </header>
  <div class="entry-content">
    <p>Source Code Analysis The goal is to access the GET /flag endpoint which calls an executable that prints out the flag. Itâ€™s guarded by 2 checks:
if session[:user] == &#34;admin&#34; if req.ip == &#34;127.0.0.1&#34; Thereâ€™s also an interesting POST /download endpoint. It accepts any session but is also guarded by the if req.ip == &#34;127.0.0.1&#34; check. It serves a file based on filename from our request, which leads to LFI.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-03 17:21:15 +0200 CEST'>September 3, 2024</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to CyberSpace CTF 2024 Notekeeper" href="http://localhost:1313/posts/cyberspacectf-2024-notekeeper/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CyberSpace CTF 2024 Trendz &amp; Trendzz &amp; Trendzzz
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>Intro This was a series of 3 web challenges (Trendz, Trendzz and Trendzzz) and 1 rev challenge (Trendzzzz) all related to one application. In this post Iâ€™ll briefly show how I solved all the web challenges related to it.
Race Condition For POST_FLAG In order to get the POST_FLAG we have to make a request to /flag after we created 12 posts.
However, the CreatePost(...) prevents us from submitting new posts once weâ€™ve created 10 of them.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-03 17:21:10 +0200 CEST'>September 3, 2024</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to CyberSpace CTF 2024 Trendz & Trendzz & Trendzzz" href="http://localhost:1313/posts/cyberspacectf-2024-trendz/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CyberSpace CTF 2024 Zip Zone
    </h2>
  </header>
  <div class="entry-content">
    <p>Initial Inspection After loading the page weâ€™re greeted with an upload form for zip archives. Weâ€™re informed that after uploading we can access the files by appending a filename to a generated UUID.
We inspect the code and learn that our uploaded archive will be unzipped using unzip.
Zip With a Symlink We can use the zip command to create an archive thatâ€™ll preserve symlinks by using the -y option.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-03 17:20:59 +0200 CEST'>September 3, 2024</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to CyberSpace CTF 2024 Zip Zone" href="http://localhost:1313/posts/cyberspacectf-2024-zip-zone/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CyberSpace CTF 2024 Feature Unlocked
    </h2>
  </header>
  <div class="entry-content">
    <p>Source Code Analysis The aim of the challenge is to call the POST /feature which contains a command injection vulnerability.
As we can see, we need a valid signed access_token that contains the string access_granted.
Thereâ€™s GET /release endpoint thatâ€™ll do exactly that if we pass the validate_server(...) check. Interestingly, if we set a query param debug=true, we can control the validation server address.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-03 17:20:52 +0200 CEST'>September 3, 2024</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to CyberSpace CTF 2024 Feature Unlocked" href="http://localhost:1313/posts/cyberspacectf-2024-feature-unlocked/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CyberSpace CTF 2024 Quiz
    </h2>
  </header>
  <div class="entry-content">
    <p>Source Code Analysis At first glance, I thought the intended vulnerability was a race condition. However, upon closer examination I noticed a suspicious unset($_SESSION[&#39;username&#39;]); in logout.php.
The correct answer for each question is random, but itâ€™s generated in advance both at the beginning of the quiz and upon submitting an answer.
The if (intval($answer) === $next_correct) {...} is the essential part of the challenge. Regardless if our answer is correct or wrong, itâ€™ll call htmlspecialchars($_SESSION[&#39;username&#39;]), which will throw an exception if username is unset in the session. However, the exception stack trace will show us which line of code the exception was thrown at. Importantly, this all happens before game-related session data is changed, such as q_num and correct.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-03 17:20:41 +0200 CEST'>September 3, 2024</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to CyberSpace CTF 2024 Quiz" href="http://localhost:1313/posts/cyberspacectf-2024-quiz/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CrewCTF 2024 Malkonkordo
    </h2>
  </header>
  <div class="entry-content">
    <p>Source Code Analysis Upon inspecting the code, we find that thereâ€™s /ai/run path that sounds like it could let us execute something.
Itâ€™s â€œguardedâ€ by middleware that inspects whether host in the uri or the request header â€˜hostâ€™ starts with 127.0.01.
Afterwards, the execution is passed to handle_cmd which can execute one of 6 commands. For us, the intereting ones are displaying env vars
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-07-29 13:00:00 +0200 CEST'>July 29, 2024</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to CrewCTF 2024 Malkonkordo" href="http://localhost:1313/posts/crewctf-2024-malkonkordo/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">DeadSec CTF 2024 Buntime
    </h2>
  </header>
  <div class="entry-content">
    <p>Initial Inspection Thereâ€™s no souce code provided for the challenge. The only thing weâ€™re given to work with is a website that executes our input code presumably using Bun.
After playing around with it for a bit we know that itâ€™s Bun, since the Bun variable is available and allows us to call different methods.
More Recon There are quite a few limitations to our code:
Bun.spawnSync function appears to be overwritten with a WAF message, WAF blocks our input from the POST body if itâ€™s too long (I didnâ€™t count it, but itâ€™s about ~30 chars give or take), We canâ€™t call await directly, Even though we can call Bun.spawn, we seemingly canâ€™t write anywhere (tried /tmp and /dev/shm), Thereâ€™s no outside network connectivity. However, weâ€™re able to confirm that the flag is in /flag.txt by running Bun.file(&#39;/flag.txt&#39;).size.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-07-29 13:00:00 +0200 CEST'>July 29, 2024</span>&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to DeadSec CTF 2024 Buntime" href="http://localhost:1313/posts/deadsecctf-2024-buntime/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">UIUCTF 2024 Log Action
    </h2>
  </header>
  <div class="entry-content">
    <p>Initial Code Analysis Upon inspecting the code, we discovered that the frontend application is running Next.js 14.1.0. This version is vulnerable to SSRF https://nvd.nist.gov/vuln/detail/CVE-2024-34351.
We also notice the flag.txt file is copied to /usr/share/nginx/html/flag.txt in the backend app, meaning itâ€™s exposed via backend/flag.txt inside the docker network.
Weâ€™ll perform an SSRF to make the frontend application send a request to the backend application /flag.txt and send it back to us.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-07-01 12:24:09 +0200 CEST'>July 1, 2024</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to UIUCTF 2024 Log Action" href="http://localhost:1313/posts/uiuctf-2024-log-action/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">HackTheBox Cyber Apocalypse 2024 Apexsurvive Writeup
    </h2>
  </header>
  <div class="entry-content">
    <p>First Steps We analyze the code and notice the email page will only show emails addressed to test@email.htb.
We create a user with the email test@email.htb and confirm the registration by visiting the link from an email.
DNS Rebinding to Activate an Internal User Upon further code inspection, we found out that users who sign up with an email hosted at apexsurvive.htb will be marked as internal users.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-03-14 17:38:37 +0100 CET'>March 14, 2024</span>&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;ShellUnease</footer>
  <a class="entry-link" aria-label="post link to HackTheBox Cyber Apocalypse 2024 Apexsurvive Writeup" href="http://localhost:1313/posts/htb-ca-2024-apexsurvive/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="http://localhost:1313/">
      Â«&nbsp;Prev&nbsp;
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>ShellUnease (CC BY 4.0)</span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<script src="/js/medium-zoom-1.1.0.min.js"></script>

<script>
 const images = Array.from(document.querySelectorAll("article img"));
 images.forEach(img => {
   mediumZoom(img, {
    
     background: 'rgba(128, 128, 128, 0.5)', 
     margin: 0,  
     scrollOffset: 40,  
     container: null,  
     template: null  
   });
 });
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
